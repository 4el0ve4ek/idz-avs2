# Индивидуальное домашнее заданее №2 по предмету Архитектура Вычислительных систем
### Аксенов Даниил, БПИ218, Вариант 17

Разработать программу, которая меняет на обратный порядок следование слов в ASCII-строке символов.

## Программа на C

Само решение задачи вызвало некоторые логические трудности. Что делать с несколькими пробелами подряд? Что делать со знаками препинания?

Было принято решение, что "словом" считается последовательный набор непробельных символов. То есть тут: `hello,    world!` словами считаются `hello,` и `world!` и тогда результатом будет `wordl!    hello,`.

По итогу была написана не самый оптимальный код на С, который считывает строку в массив, выполняет функцию `reverse_words` которая меняет порядок символов, и выводит строку.

Код был разбит на два файла `main.c` и `common.c`, последний содержит функции чтения и записи.

Дабы получить оценку побольше(7), было добавлено чтение из файла. При запуске программы можно в качестве параметров передать файлы для ввода и вывода. В таком случае  программа прочитает первый файл и запишет ответ во второй.

## Программа на asm
Скомпилировал каждый файл с флагами `-O0 -Wall -masm=intel -S -fno-asynchronous-unwind-tables` и получил два файла `main.s` и `common.s` содержащие 600 строк кода на ассемблере... Приступил к комментированию. Описал полностью работу этого кода. Файлы лежат рядом с readme файлом)


Потом решил получить оценку больше(6 баллов) и добавил использование регистров в некоторых местах функций. В папке `modifier` лежат файлы `common.s` и `main.s`  с немного измененными функциями, например функция read_string теперь не использует память на стеке и обходиться только регистрами 

![](/screenshots/refactor_1.png)

Так же были изменены некоторые другие функции и добавлены комментарии, поясняющие что в каком регистре лежит.


### Конечне файлы:
- `main.c` - код программы на языке C

- `common.c` - функции чтения и записи на языке C

- `main.s` - ассемблерный код __с комментариями__, полученный при компиляции `main.c` с флагами `-O0 -Wall -masm=intel -S -fno-asynchronous-unwind-tables`

- `common.s` - ассемблерный код __с комментариями__, полученный при компиляции `common.c` с флагами `-O0 -Wall -masm=intel -S -fno-asynchronous-unwind-tables`

- `modified/common.s` - изменненый код из файла `common.s`, в котором чаще используются регистры

- `modified/main.s` - изменненый код из файла `main.s`, в котором чаще используются регистры

- `staff/main.o` и `staff/common.o` - промежуточные файлы, которые потребовались для генерации запускаемого файла из ассемблерного кода

- `main_std` - скомпилированная программа из `main.c` и `common.c`

- `main_asm` - скомпилированный ассемблерный код из файлов
`modified/main.s` и `modified/common.s`

- в папке `test` лежат тесты и корректные ответы на них

### Тесты

#### Тест 1
Входные данные(`test/input1.txt`):
```
ab cde fghi jkl
```
Ожидаемые выходные данные(`test/output1.txt`):
```
jkl fghi cde ab
```
Результаты тестов:
![](/screenshots/test_base_1.png)
![](/screenshots/test_asm_1.png)
#### Тест 2
Входные данные(`test/input2.txt`):
```
hello, world!
i'm fine!
```
Ожидаемые выходные данные(`test/output2.txt`):
```
fine! i'm
world! hello,
```
![](/screenshots/test_base_2.png)
![](/screenshots/test_asm_2.png)

#### Тест 3
Входные данные(`test/inputs3.txt`):
```
ab        cde     fg
```
Ожидаемые выходные данные(`test/output3.txt`):
```
fg        cde     ab
```
![](/screenshots/test_base_3.png)
![](/screenshots/test_asm_3.png)
